<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>How to Translate a Math PDF (Co-written with Gemini 2.5 Pro)</title>
    <style>
        /* Basic styling for readability */
        body { font-family: sans-serif; line-height: 1.6; margin: 2em; }
        h1, h2, h3, h4 { margin-top: 1.5em; }
        pre { background-color: #f4f4f4; padding: 1em; border: 1px solid #ddd; overflow-x: auto; white-space: pre-wrap; /* Wrap long lines */ word-wrap: break-word; /* Break words if needed */ }
        code { font-family: monospace; }
        ul, ol { margin-left: 1.5em; }
        li { margin-bottom: 0.5em; }
        /* Style to visually separate Gemini's explanation */
        .gemini-explanation { border-left: 4px solid #4285F4; /* Google blue */ padding-left: 1em; margin-top: 1.5em; margin-bottom: 1.5em;}
        /* Style for the API/Env notes section */
        .api-notes { border-left: 4px solid #34A853; /* Google green */ padding-left: 1em; margin-top: 1.5em; }
    </style>
</head>
<body>

<h1>How to Translate a Math PDF (Co-written with Gemini 2.5 Pro)</h1>

<p>Nowadays, multimodal AI models can take as input a math paper in a non-English language and output a translation directly in LaTeX. Below is a guide on this. Before proceeding, beware that there are always risks of hallucination or error from the AI and from the fact that this guide was written in April 2025 and was suboptimal even when written.</p>

<p>A quick note: for this to work, the core capability for this task has to exist in the multimodal AI itself. The guide below merely provides scaffolding to overcome the following two common challenges:</p>
<ul>
    <li><strong>Output Length Limits:</strong> AIs often can't generate the entire LaTeX for a long paper in one output, especially via API calls.</li>
    <li><strong>AI Confusion from Input Size:</strong> Processing hundreds of pages of math can sometimes lead to a degradation in translation ability or increased errors.</li>
</ul>

<p>We divide this guide into two main situations.</p>

<h2>Situation 1 (Easiest): Translating Short Papers (e.g., < 20 pages)</h2>

<p>If the paper is short, you can often translate it directly using a chat interface for any capable multimodal AI model (like Google's AI Studio for Gemini).</p>
<ol>
    <li><strong>Method:</strong> Upload the PDF directly into the chat interface.</li>
    <li><strong>Prompt:</strong> Use a prompt like this:
        <pre><code>Please translate the uploaded document into English LaTeX code. Ensure all mathematical formulas and environments are preserved correctly. Generate the complete LaTeX document, including a suitable preamble.</code></pre>
    </li>
    <li><strong>Process:</strong> Copy the AI's generated LaTeX output, paste it into your LaTeX editor (e.g., Overleaf), compile, and carefully review the resulting PDF.</li>
</ol>

<h2>Situation 2: Translation for Longer Papers via an API</h2>

<p>For longer papers, we must divide the paper into manageable chunks for translation. Using the Gemini API, it is possible to write code to automate this process. The philosophy here is that the scaffolding imposed on the AI model should be minimal, so as not to interfere with the AI's own ability to process and translate effectively.</p>

<p>The basic script workflow involves these steps:</p>
<ol>
    <li>Determine how to split the PDF into chunks (e.g., based on logical sections suggested by the AI, or simply using fixed page counts).</li>
    <li>Call the Gemini API for each chunk, sending the relevant pages (potentially as images or extracted text, depending on the chosen API capabilities and complexity) for translation into LaTeX format.</li>
    <li>Combine the resulting LaTeX pieces generated for each chunk into a single, final <code>.tex</code> file.</li>
</ol>

<!-- User's corrected paragraph -->
<p>We provide an <a href="pdf_latex_translator.py" download>example script</a> written with Gemini.
<!-- Make sure pdf_latex_translator.py is in the same directory as this HTML file, or adjust the href path -->
In order the use this script, you first need to obtain a Gemini API key and set up a Python environment with the necessary libraries installed. </p>

<p>I'll let Gemini explain in more detail:</p>

<div class="gemini-explanation"> <!-- Added class back for styling -->
    <h3>How to Use the Python Script</h3>
    <p>(Assuming you have downloaded the <code>pdf_latex_translator.py</code> script)</p>

    <h4>1. Set Up Python Environment:</h4>
    <p>Ensure you have Python installed on your system. If not, you can download it from the <a href="https://www.python.org/downloads/" target="_blank" rel="noopener noreferrer">official Python website</a> (this typically includes pip, the package installer).</p>


    <h4>2. Install Libraries:</h4>
    <p>Open your terminal or command prompt and run:</p>
    <pre><code>pip install google-generativeai pypdf python-dotenv</code></pre>
    <p><em>Note: Depending on your system configuration, you might need to use <code>pip3</code> instead of <code>pip</code>. See the section below on Python Environment Best Practices.</em></p>


    <h4>3. Set up API Key:</h4>
    <ul>
        <li>Create a file named <code>.env</code> in the same directory as the script.</li>
        <li>Add your Gemini API key to the <code>.env</code> file like this:
            <pre><code>GEMINI_API_KEY=YOUR_API_KEY_HERE</code></pre>
            (Replace <code>YOUR_API_KEY_HERE</code> with your actual key).
        </li>
        <li>Alternatively, you can set <code>GEMINI_API_KEY</code> as an environment variable directly in your operating system.</li>
    </ul>

    <h4>4. Run the Script:</h4>
    <p>Execute the script from your terminal:</p>
    <pre><code>python pdf_latex_translator.py "path/to/your/document.pdf" "path/to/output/translated_document.tex"</code></pre>
    <ul>
        <li>Replace <code>"path/to/your/document.pdf"</code> with the actual path to your input PDF file.</li>
        <li>Replace <code>"path/to/output/translated_document.tex"</code> with the desired path for the output LaTeX file.</li>
        <li><em>Note: Depending on your system configuration, you might need to use <code>python3</code> instead of <code>python</code>.</em></li>
    </ul>

    <h4>5. Optional Arguments:</h4>
    <p>You can modify the script's behavior using command-line arguments:</p>
    <ul>
        <li><code>--env path/to/.env</code>: Specify a different path for the <code>.env</code> file if it's not in the same directory.</li>
        <li><code>--chunk_size N</code>: Set the number of pages per chunk if AI chunking fails or is disabled (default is 10).</li>
        <li><code>--disable_ai_chunking</code>: Force the script to use fixed-size chunks instead of trying the experimental AI chunking.</li>
        <li><code>--model model_name</code>: Specify a different Gemini model (e.g., <code>gemini-1.0-pro</code>). The default is typically <code>gemini-1.5-flash</code> which is often suitable for this task. Check Google's documentation for available models and capabilities, including free experimental models like <code>gemini-2.5-pro-exp-03-25</code> (as of April 2025).</li>
    </ul>

    <h3>Explanation and Key Features of the Script</h3>
    <p>(This section outlines the script's internal logic. Refer to the script's comments for full details.)</p>
    <ul>
        <li><strong>API Key Loading:</strong> Securely loads the API key.</li>
        <li><strong>PDF Handling:</strong> Uses <code>pypdf</code> for page reading and text extraction.</li>
        <li><strong>Chunking Strategy:</strong> Attempts AI-driven chunking, falls back to fixed chunks.</li>
        <li><strong>Gemini Translation:</strong> Constructs specific prompts for first vs. subsequent chunks to handle LaTeX preamble correctly. Preserves math.</li>
        <li><strong>Combining Output:</strong> Joins parts, ensures correct document structure.</li>
        <li><strong>Error Handling:</strong> Includes checks for file, PDF, and API issues.</li>
        <li><strong>Command-Line Interface:</strong> Uses <code>argparse</code> for flexibility.</li>
        <li><strong>Logging:</strong> Provides progress updates.</li>
    </ul>
</div> <!-- End of gemini-explanation div -->

<!-- New Section for API/Env Notes -->
<div class="api-notes">
    <h3>Notes on Gemini API Key, Pricing, and Python Environments</h3>

    <h4>Obtaining a Gemini API Key</h4>
    <p>To use the script, you need an API key. You can get one from <a href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener noreferrer">Google AI Studio</a>. Using Google AI Studio itself is generally free.</p>

    <h4>Gemini API Pricing (as of April 2025 - subject to change)</h4>
    <ul>
        <li><strong>Free Tier via API:</strong> Google offers a free tier for the Gemini API, typically with lower usage limits (requests per minute) suitable for testing and development. This is distinct from the free usage of AI Studio. Data submitted via the free API tier might be used by Google to improve products.</li>
        <li><strong>Paid Tier via API:</strong> Offers higher rate limits, potentially access to more models or features, and generally does not use submitted data for product improvement. Costs are typically per token (input and output).</li>
        <li><strong>Using Free Experimental Models:</strong> Google sometimes offers preview or experimental models via the API for free, like <code>gemini-2.5-pro-exp-03-25</code> mentioned in their pricing. You can specify these using the script's <code>--model</code> argument (e.g., <code>--model gemini-2.5-pro-exp-03-25</code>) to access them if available. These may have specific terms or change without notice.</li>
        <li><strong>Default Model:</strong> The script might default to a model like <code>gemini-1.5-flash</code>. This model also has free/paid tiers via the API. Check the script's default and the <a href="https://ai.google.dev/pricing" target="_blank" rel="noopener noreferrer">official Gemini API pricing page</a> for current details.</li>
    </ul>

    <h4>Python Environment Best Practices (Using `venv`)</h4>
    <p>It's highly recommended to use a virtual environment when working with Python projects and installing libraries like those needed for this script. This prevents conflicts between dependencies required by different projects.</p>
    <ol>
        <li><strong>Create a Virtual Environment:</strong> Navigate to your project directory in the terminal and run:
            <pre><code>python -m venv venv</code></pre>
            <em>(Or use <code>python3</code> if needed: <code>python3 -m venv venv</code>). This creates a folder named <code>venv</code> containing a private Python installation.</em>
        </li>
        <li><strong>Activate the Environment:</strong>
            <ul>
                <li><strong>On Windows (cmd.exe):</strong> <code>venv\Scripts\activate.bat</code></li>
                <li><strong>On Windows (PowerShell):</strong> <code>venv\Scripts\Activate.ps1</code> (You might need to adjust execution policy: <code>Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope Process</code>)</li>
                <li><strong>On macOS/Linux (bash/zsh):</strong> <code>source venv/bin/activate</code></li>
            </ul>
            <em>Your terminal prompt should change to indicate the environment is active (e.g., `(venv) your-prompt$`).</em>
        </li>
        <li><strong>Install Libraries:</strong> Now, run the <code>pip install ...</code> command mentioned earlier. Libraries will be installed inside the active virtual environment, isolated from your global Python installation.</li>
        <li><strong>Deactivate:</strong> When you're finished working, simply type <code>deactivate</code> in the terminal.</li>
    </ol>
    <p>For more details, see the official Python documentation on <a href="https://docs.python.org/3/library/venv.html" target="_blank" rel="noopener noreferrer">Creation of virtual environments</a>.</p>
</div> <!-- End of api-notes div -->

<p>You can download the example Python script discussed above here: <a href="pdf_latex_translator.py" download>pdf_latex_translator.py</a>.</p>
<!-- Make sure pdf_latex_translator.py is in the same directory as this HTML file, or adjust the href path -->

</body>
</html>
